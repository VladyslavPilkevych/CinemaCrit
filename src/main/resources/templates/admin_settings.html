<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settings</title>
    <link href="/css/bootstrap.min.css" rel="stylesheet">

    <style>
        .bd-placeholder-img {
            font-size: 1.125rem;
            text-anchor: middle;
            -webkit-user-select: none;
            -moz-user-select: none;
            user-select: none;
        }

        @media (min-width: 768px) {
            .bd-placeholder-img-lg {
                font-size: 3.5rem;
            }
        }
    </style>


    <!-- Custom styles for this template -->
    <link href="dashboard.css" rel="stylesheet">
    <link href="headers.css" rel="stylesheet">
</head>
<body>
<script th:inline="javascript">
    const adminValue = localStorage.getItem("admin");
    if (adminValue === "admin") {
    } else {
        window.location.href = "/error";
    }
</script>
<div class="container fixed-top">
    <header class="bg-white d-flex flex-wrap align-items-center justify-content-center justify-content-md-between py-3 mb-4 border-bottom">
        <ul class="nav col-12 col-md-auto mb-2 justify-content-center mb-md-0">
            <li><a href="/movies" class="nav-link px-2 link-secondary">Home</a></li>
        </ul>
        <div class="col-md-3 text-end">
            <a type="button" href="/movies" id="logoutAdmin" class="btn btn-outline-primary me-2">Log out</a>
        </div>
    </header>
</div>
<main class="container" style="padding-top: 70px">
    <h1>Settings</h1>

    <div class="container-fluid">
        <div class="row">
            <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block bg-light sidebar collapse">
                <div class="position-sticky pt-3">
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link active" aria-current="page" href="#">
                                <span data-feather="home"></span>
                                Customers
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>

            <div class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2"></h1>
                    <div class="btn-toolbar mb-2 mb-md-0">
                        <div class="btn-group me-2">
                            <button type="button" class="btn btn-sm btn-outline-secondary">Share</button>
                            <button type="button" class="btn btn-sm btn-outline-secondary">Export</button>
                        </div>
                        <button type="button" class="btn btn-sm btn-outline-secondary dropdown-toggle">
                            <span data-feather="calendar"></span>
                            This week
                        </button>
                    </div>
                </div>

                <h2>Users</h2>
                <div class="table-responsive">
                    <table class="table table-striped table-sm">
                        <thead>
                        <tr>
                            <th scope="col">id</th>
                            <th scope="col">User</th>
<!--                            <th scope="col">Comments</th> // TODO: implement -->
                            <th scope="col"></th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr th:each="user : ${users}">
                            <td th:text="${user.id}" class="userId"></td>
                            <td th:text="${user.username}"></td>
<!--                            <td th:text="${review.stream().filter(elem->elem.username.equals(user.username)).count()}"></td> // TODO: implement -->
<!--                            <td><button type="button" class="btn btn-danger p-1">Remove</button></td>-->
                            <td>
                                <form th:action="@{/delete/user}" method="post">
                                    <input type="hidden" th:name="userId" th:value="${user.id}" />
                                    <button type="submit" class="btn btn-danger p-1">Remove</button>
                                </form>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

</main>
<script src="/js/bootstrap.bundle.min.js"></script>

<script src="/js/authentication.js"></script>
<!--<script>-->
<!--    const deleteUsersButtons = [...document.getElementsByClassName("btn-danger")];-->
<!--    deleteUsersButtons.forEach((btn) => {-->
<!--        btn.addEventListener("click", function (event) {-->
<!--            let parentTr = event.target.closest("tr");-->
<!--            let userId = parentTr.querySelector(".userId").textContent;-->
<!--            new Promise((resolve, reject) => {-->
<!--                fetch('/delete/user', {-->
<!--                    method: 'POST',-->
<!--                    headers: {-->
<!--                        'Content-Type': 'application/json'-->
<!--                    },-->
<!--                    body: JSON.stringify(Number(userId))-->
<!--                })-->
<!--                    .then(response => {-->
<!--                        console.log(response)-->
<!--                        if (response.ok) {-->
<!--                            window.location.reload();-->
<!--                        } else {-->
<!--                            console.log('Error removing user:', response.statusText);-->
<!--                        }-->
<!--                    })-->
<!--                    .catch(error => {-->
<!--                        console.log('Error removing user:', error);-->
<!--                    });-->
<!--            });-->
<!--        });-->
<!--    });-->
<!--</script>-->
<script src="/js/admin.js"></script>
</body>
</html>
